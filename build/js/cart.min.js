(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var l=t[r];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,o(l.key),l)}}function o(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var l=r.call(t,o||"default");if("object"!=e(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}var r,l,n,c=function(){return e=function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._target=t,this._duration=o},(o=[{key:"show",value:function(){var e=this._target;if(!e.classList.contains("collapsing")&&!e.classList.contains("_show")){e.classList.remove("_collapse");var t=e.offsetHeight;e.style.height=0,e.style.overflow="hidden",e.style.transition="height ".concat(this._duration,"ms ease"),e.classList.add("collapsing"),e.offsetHeight,e.style.height="".concat(t,"px"),window.setTimeout((function(){e.classList.remove("collapsing"),e.classList.add("_collapse"),e.classList.add("_show"),e.style.height="",e.style.transition="",e.style.overflow=""}),this._duration)}}},{key:"hide",value:function(){var e=this._target;!e.classList.contains("collapsing")&&e.classList.contains("_show")&&(e.style.height="".concat(e.offsetHeight,"px"),e.offsetHeight,e.style.height=0,e.style.overflow="hidden",e.style.transition="height ".concat(this._duration,"ms ease"),e.classList.remove("_collapse"),e.classList.remove("_show"),e.classList.add("collapsing"),window.setTimeout((function(){e.classList.remove("collapsing"),e.classList.add("_collapse"),e.style.height="",e.style.transition="",e.style.overflow=""}),this._duration))}},{key:"toggle",value:function(){this._target.classList.contains("_show")?this.hide():this.show()}}])&&t(e.prototype,o),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,r}();document.querySelector(".page__header"),document.querySelector(".header__button-sidebarcatalog"),document.querySelector(".burger-button"),document.querySelector(".page__sidebar-catalog"),document.querySelector(".page__sidebar-menu"),document.querySelector(".page__buttom-menu"),document.querySelector(".catalog-cansel"),document.querySelector(".menu-cansel"),document.querySelectorAll(".menu-catalog__parent-menu"),document.querySelector(".menu-catalog"),document.querySelector(".catalog__categories"),document.querySelectorAll(".submenu-parent"),document.querySelectorAll(".login-container__user-button"),document.querySelectorAll(".slide-container__favourit");function a(e,t,o){Array.isArray(e)||(e=[]),t.forEach((function(t){e.includes(t.textContent.trim())?t.classList.add("_selected"):t.classList.remove("_selected")})),s(e,o)}function s(e,t){if(t)if(e&&0!==e.length)if(1===e.length)t.value=e[0];else{var o=e[0],r=e.length-1;t.value="".concat(o," + ещё ").concat(r)}else t.value="Не выбрано"}!function(){var e=document.querySelectorAll("[data-quantity]"),t=document.querySelectorAll(".product-price");function o(){var e=0;t.forEach((function(t){var o=document.querySelector(".input-total"),r=(parseFloat(t.textContent.replace(/ /g,"").replace(",","."))||0)*(parseFloat(t.closest(".product-cart").querySelector("input").value)||1);e+=r,t.closest(".product-cart").querySelector(".product-cart__quantity-price").textContent=r.toLocaleString("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}),o.innerHTML="Итого: "+e.toLocaleString()+'<i class="icon-rub"></i>'}))}e&&e.forEach((function(e){var t=!1;e.addEventListener("click",(function(e){var r=e.target;if(r.closest(".quantity__button")){var l=r.closest(".quantity").querySelector("input"),n=parseFloat(l.value)||0;r.classList.contains("quantity-add")?n+=.1:r.classList.contains("quantity-remove")&&(n-=.1),n=Math.max(.3,parseFloat(n.toFixed(2))),l.value=n.toFixed(2),n<=.3?function(e){e.closest(".quantity").querySelector(".quantity-remove").classList.add("_disabled")}(l):function(e){e.closest(".quantity").querySelector(".quantity-remove").classList.remove("_disabled")}(l),o(),t=!1}}));var r=e.querySelector("input");r.addEventListener("input",(function(e){var o=r.selectionStart;if(this.value=this.value.replace(/[^0-9.]/g,""),(this.value.match(/\./g)||[]).length>1){var l=this.value.lastIndexOf("."),n=Math.max(o,l),c=Math.min(o,l);this.value=this.value.slice(0,c)+this.value.slice(c+1,n)+this.value.slice(n+1),o--}else this.value.includes(".")&&!t&&(o++,t=!0);r.setSelectionRange(o,o)})),r.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),o())}))})),o()}(),r=document.querySelector(".send-order"),l=new c(r.querySelector("._collapse")),n=document.querySelector(".order-place__checkbox"),document.querySelector(".order-place__form-button").addEventListener("click",(function(){var e=document.querySelector(".cart-page__title"),t=document.querySelector(".order-place__send-button"),o=document.querySelector(".order-place__form-button");e.innerHTML="оформление заказа",l.toggle(),t.style.display="block",o.style.display="none",n.style.display="block"})),function(){var e=function(){try{var e=localStorage.getItem("filters");return e?JSON.parse(e):{}}catch(e){return console.warn("[select] loadFiltersFromLocal: JSON parse error, returning {}",e),{}}}();function t(){document.querySelectorAll(".select._active-collapse").forEach((function(e){var t=e.querySelector("._collapse");if(t){var o=new c(t);try{o.toggle()}catch(e){}}e.classList.remove("_active-collapse")}))}document.addEventListener("click",(function(e){e.target.closest(".select")||t()})),document.addEventListener("keydown",(function(e){"Tab"!==e.key&&"Escape"!==e.key||t()})),document.querySelectorAll("[data-select]").forEach((function(o){Array.from(o.querySelectorAll(".select")).forEach((function(o){var r=Array.from(o.querySelectorAll(".select__list-item")),l=o.querySelector(".select__button"),n=l?l.getAttribute("data-select-key"):null;n||console.warn("[select] data-select-key отсутствует для",o);var i=r.length>0?r[0]:null;function u(e){null!==e&&(i&&i.classList.remove("_selected"),e.focus(),e.classList.add("_selected"),i=e)}n?(Array.isArray(e[n])||(e[n]=[]),a(e[n],r,l)):a([],r,l),o.addEventListener("click",(function(t){var r=t.target;if(r.closest(".select__button")){var c=document.querySelector("._active-collapse");if(d(o),r.closest(".select__box-button")){var a=r.closest(".select__box-button").nextElementSibling;if(a){var u=a.querySelector("._selected");u&&(i=u)}}o.classList.contains("_active-collapse")||l&&l.blur(),c&&c!==o&&d(c)}var y=r.closest(".select__list-item");if(y&&o.contains(y)){var f=y.textContent.trim();n?(Array.isArray(e[n])||(e[n]=[]),e[n].includes(f)?(e[n]=e[n].filter((function(e){return e!==f})),y.classList.remove("_selected"),console.log('[select] Removed value "'.concat(f,'" from key "').concat(n,'"'))):(e[n].push(f),y.classList.add("_selected"),console.log('[select] Added value "'.concat(f,'" to key "').concat(n,'"'))),function(e){try{localStorage.setItem("filters",JSON.stringify(e))}catch(e){console.error("[select] saveFiltersToLocal failed:",e)}}(e),s(e[n],l)):(y.classList.toggle("_selected"),s(Array.from(o.querySelectorAll("._selected")).map((function(e){return e.textContent.trim()})),l))}})),o.addEventListener("keydown",(function(e){if(["ArrowUp","ArrowDown","Enter"].includes(e.key))if(e.preventDefault(),"ArrowUp"===e.key)u(i?i.previousElementSibling:null);else if("ArrowDown"===e.key){u(i?i.nextElementSibling:null)}else"Enter"===e.key&&(!function(){if(!i)return;l&&(l.value=i.textContent.trim(),l.blur())}(),t())}));var d=function(e){var t=e.querySelector("._collapse");if(t){var o=new c(t);e.classList.contains("_active-collapse")?(e.classList.remove("_active-collapse"),o.toggle()):(e.classList.add("_active-collapse"),o.toggle())}}}))}))}()})();