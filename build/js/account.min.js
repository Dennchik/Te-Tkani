(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var n=0;n<t.length;n++){var c=t[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,o(c.key),c)}}function o(t){var o=function(t,o){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var c=n.call(t,o||"default");if("object"!=e(c))return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==e(o)?o:o+""}var n=function(){return e=function e(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:350;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._target=t,this._duration=o},(o=[{key:"show",value:function(){var e=this._target;if(!e.classList.contains("collapsing")&&!e.classList.contains("_show")){e.classList.remove("_collapse");var t=e.offsetHeight;e.style.height=0,e.style.overflow="hidden",e.style.transition="height ".concat(this._duration,"ms ease"),e.classList.add("collapsing"),e.offsetHeight,e.style.height="".concat(t,"px"),window.setTimeout((function(){e.classList.remove("collapsing"),e.classList.add("_collapse"),e.classList.add("_show"),e.style.height="",e.style.transition="",e.style.overflow=""}),this._duration)}}},{key:"hide",value:function(){var e=this._target;!e.classList.contains("collapsing")&&e.classList.contains("_show")&&(e.style.height="".concat(e.offsetHeight,"px"),e.offsetHeight,e.style.height=0,e.style.overflow="hidden",e.style.transition="height ".concat(this._duration,"ms ease"),e.classList.remove("_collapse"),e.classList.remove("_show"),e.classList.add("collapsing"),window.setTimeout((function(){e.classList.remove("collapsing"),e.classList.add("_collapse"),e.style.height="",e.style.transition="",e.style.overflow=""}),this._duration))}},{key:"toggle",value:function(){this._target.classList.contains("_show")?this.hide():this.show()}}])&&t(e.prototype,o),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,o,n}();function c(){var e=function(){try{var e=localStorage.getItem("filters");return e?JSON.parse(e):{}}catch(e){return console.warn("[select] loadFiltersFromLocal: JSON parse error, returning {}",e),{}}}();function t(){document.querySelectorAll(".select._active-collapse").forEach((function(e){var t=e.querySelector("._collapse");if(t){var o=new n(t);try{o.toggle()}catch(e){}}e.classList.remove("_active-collapse")}))}document.addEventListener("click",(function(e){e.target.closest(".select")||t()})),document.addEventListener("keydown",(function(e){"Tab"!==e.key&&"Escape"!==e.key||t()})),document.querySelectorAll("[data-select]").forEach((function(o){Array.from(o.querySelectorAll(".select")).forEach((function(o){var c=Array.from(o.querySelectorAll(".select__list-item")),s=o.querySelector(".select__button"),a=s?s.getAttribute("data-select-key"):null;a||console.warn("[select] data-select-key отсутствует для",o);var i=c.length>0?c[0]:null;function u(e){null!==e&&(i&&i.classList.remove("_selected"),e.focus(),e.classList.add("_selected"),i=e)}a?(Array.isArray(e[a])||(e[a]=[]),l(e[a],c,s)):l([],c,s),o.addEventListener("click",(function(t){var n=t.target;if(n.closest(".select__button")){var c=document.querySelector("._active-collapse");if(d(o),n.closest(".select__box-button")){var l=n.closest(".select__box-button").nextElementSibling;if(l){var u=l.querySelector("._selected");u&&(i=u)}}o.classList.contains("_active-collapse")||s&&s.blur(),c&&c!==o&&d(c)}var v=n.closest(".select__list-item");if(v&&o.contains(v)){var y=v.textContent.trim();a?(Array.isArray(e[a])||(e[a]=[]),e[a].includes(y)?(e[a]=e[a].filter((function(e){return e!==y})),v.classList.remove("_selected"),console.log('[select] Removed value "'.concat(y,'" from key "').concat(a,'"'))):(e[a].push(y),v.classList.add("_selected"),console.log('[select] Added value "'.concat(y,'" to key "').concat(a,'"'))),function(e){try{localStorage.setItem("filters",JSON.stringify(e))}catch(e){console.error("[select] saveFiltersToLocal failed:",e)}}(e),r(e[a],s)):(v.classList.toggle("_selected"),r(Array.from(o.querySelectorAll("._selected")).map((function(e){return e.textContent.trim()})),s))}})),o.addEventListener("keydown",(function(e){if(["ArrowUp","ArrowDown","Enter"].includes(e.key))if(e.preventDefault(),"ArrowUp"===e.key)u(i?i.previousElementSibling:null);else if("ArrowDown"===e.key){u(i?i.nextElementSibling:null)}else"Enter"===e.key&&(!function(){if(!i)return;s&&(s.value=i.textContent.trim(),s.blur())}(),t())}));var d=function(e){var t=e.querySelector("._collapse");if(t){var o=new n(t);e.classList.contains("_active-collapse")?(e.classList.remove("_active-collapse"),o.toggle()):(e.classList.add("_active-collapse"),o.toggle())}}}))}))}function l(e,t,o){Array.isArray(e)||(e=[]),t.forEach((function(t){e.includes(t.textContent.trim())?t.classList.add("_selected"):t.classList.remove("_selected")})),r(e,o)}function r(e,t){if(t)if(e&&0!==e.length)if(1===e.length)t.value=e[0];else{var o=e[0],n=e.length-1;t.value="".concat(o," + ещё ").concat(n)}else t.value="Не выбрано"}var s=document.querySelector(".toggle-wrap"),a=document.querySelector(".personal-account__column");s.addEventListener("click",(function(){i.classList.toggle("_open"),a.classList.toggle("_opened-menu")}));var i=document.querySelector(".toggle-menu");var u=window.scrollY;window.addEventListener("scroll",(function(){var e=window.scrollY,t=window.innerWidth;t<690?(a.style.top="47px",u>e?(a.style.top="47px",a.style.height="calc(100% - (46px + 58px))"):u>150&&(a.style.height="100%",a.style.top="0"),u=e):t>690&&(a.style.top="113.76px",u>e?(a.style.top="113.76px",a.style.height="calc(100% - 113.76px)"):u>150&&(a.style.height="100%",a.style.top="0"),u=e)}));var d=document.querySelector(".user-bar__list");document.querySelectorAll(".user-bar__item").forEach((function(e){e.addEventListener("click",(function(){var t=d.querySelector("._active");v(e),t&&t!==e&&v(t),t&&t===e&&v(e)}))}));var v=function(e){e.classList.contains("_active")?(e.classList.remove("_active"),i.classList.remove("_open"),a.classList.remove("_opened-menu")):e.classList.add("_active")};document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".personal-account__personal-data");document.querySelectorAll(".link").forEach((function(t){t.addEventListener("click",(function(){!function(t){fetch("user-data/".concat(t,".html")).then((function(e){return e.text()})).then((function(o){var l,r,s;e.innerHTML=o,"order-cart"===t?(c(),function(){var e=document.querySelectorAll("[data-quantity]"),t=document.querySelectorAll(".product-price");function o(){var e=0;t.forEach((function(t){var o=document.querySelector(".input-total"),n=(parseFloat(t.textContent.replace(/ /g,"").replace(",","."))||0)*(parseFloat(t.closest(".product-cart").querySelector("input").value)||1);e+=n,t.closest(".product-cart").querySelector(".product-cart__quantity-price").textContent=n.toLocaleString("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}),o.innerHTML="Итого: "+e.toLocaleString()+'<i class="icon-rub"></i>'}))}e&&e.forEach((function(e){var t=!1;e.addEventListener("click",(function(e){var n=e.target;if(n.closest(".quantity__button")){var c=n.closest(".quantity").querySelector("input"),l=parseFloat(c.value)||0;n.classList.contains("quantity-add")?l+=.1:n.classList.contains("quantity-remove")&&(l-=.1),l=Math.max(.3,parseFloat(l.toFixed(2))),c.value=l.toFixed(2),l<=.3?function(e){e.closest(".quantity").querySelector(".quantity-remove").classList.add("_disabled")}(c):function(e){e.closest(".quantity").querySelector(".quantity-remove").classList.remove("_disabled")}(c),o(),t=!1}}));var n=e.querySelector("input");n.addEventListener("input",(function(e){var o=n.selectionStart;if(this.value=this.value.replace(/[^0-9.]/g,""),(this.value.match(/\./g)||[]).length>1){var c=this.value.lastIndexOf("."),l=Math.max(o,c),r=Math.min(o,c);this.value=this.value.slice(0,r)+this.value.slice(r+1,l)+this.value.slice(l+1),o--}else this.value.includes(".")&&!t&&(o++,t=!0);n.setSelectionRange(o,o)})),n.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),o())}))})),o()}(),l=document.querySelector(".send-order"),r=new n(l.querySelector("._collapse")),s=document.querySelector(".order-place__checkbox"),document.querySelector(".order-place__form-button").addEventListener("click",(function(){var e=document.querySelector(".order-place__send-button"),t=document.querySelector(".order-place__form-button");r.toggle(),e.style.display="block",t.style.display="none",s.style.display="block"}))):"feed-back"===t?(console.log("yes"),c()):"history-order"===t&&function(){var e=document.getElementById("start-date"),t=document.getElementById("end-date");function o(){var o=new Date(e.value),n=new Date(t.value);o>n?alert('Дата "до" не может быть раньше даты "от".'):console.log("Выбранный диапазон дат: От ".concat(o.toLocaleDateString()," до ").concat(n.toLocaleDateString()))}e.addEventListener("change",(function(){console.log("Start date selected:",e.value),o()})),t.addEventListener("change",(function(){console.log("End date selected:",t.value),o()}))}()})).catch((function(t){e.innerHTML="Error loading content"}))}(this.getAttribute("data-page"))}))}))}))})();